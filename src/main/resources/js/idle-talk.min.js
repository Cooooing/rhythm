var IdleTalk={editor:void 0,revoke:function(t){!0===confirm("确定要撤回这封信吗？对方将无法再打开这封信，同时你的积分将不会被退还。")&&$.ajax({url:Label.servePath+"/idle-talk/revoke?mapId="+t,type:"GET",headers:{csrfToken:Label.csrfToken},cache:!1,success:function(e){-1===e.code?alert(e.msg):$("#"+t).remove()}})},seek:function(t){$.ajax({url:Label.servePath+"/idle-talk/seek?mapId="+t,type:"GET",headers:{csrfToken:Label.csrfToken},cache:!1,success:function(e){-1===e.code?alert(e.msg):($("#"+t).append("<div id='seek-"+t+"' style='background-color: #F7F7F7;display:none;overflow: auto;padding: 20px;'>"+e.data+"<br><button class='btn' style='margin: 20px' onclick='$(\"#"+t+"\").remove();'>朕已阅，可以销毁了</button></div>"),$("#seek-"+t).show(200))}})},send:function(){$.ajax({url:Label.servePath+"/idle-talk/send",type:"POST",headers:{csrfToken:Label.csrfToken},cache:!1,data:JSON.stringify({userName:$("#userForm").val(),theme:$("#themeForm").val(),content:IdleTalk.getContent()}),success:function(e){-1===e.code?alert(e.msg):($("#userForm").val(""),$("#themeForm").val(""),IdleTalk.editor.setValue(""))}})},init:function(){IdleTalk.editor=Util.newVditor({id:"messageContent",cache:!0,preview:{mode:"editor"},resize:{enable:!0,position:"top"},height:200,counter:4096,placeholder:"信柬内容（最长20480个字）"});var e=IdleTalk.getUrlPath("toUser");!1!==e&&(IdleTalk.expand(),$("#userForm").val(e))},getContent:function(){return IdleTalk.editor.getValue()},expand:function(){$("#sendMessageWindow").is(":hidden")?($("#title").css("padding","230px 0 20px 0"),$("#sendMessageWindow").fadeIn(200)):($("#title").css("padding","20px 0 20px 0"),$("#sendMessageWindow").fadeOut(200))},getUrlPath:function(e){for(var t=window.location.search.substring(1).split("&"),a=0;a<t.length;a++){var n=t[a].split("=");if(n[0]==e)return n[1]}return!1}};$(document).ready(function(){IdleTalk.init()});